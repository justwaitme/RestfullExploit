import { Component, OnInit } from '@angular/core';
import { ArticleService } from '../../services/article.service';
import { NgForm } from '@angular/forms';

@Component({
  selector: 'app-home',
  templateUrl: './home.component.html',
  styleUrls: ['./home.component.css']
})
export class HomeComponent implements OnInit {

  Articles;
  ArticleToEdit:boolean =false;
  articleE;
  constructor(private articleservice: ArticleService) { }

  AddContent(form: NgForm) {
    console.log(form.value);
    this.articleservice.Push(form);
    location.reload();
  }


  HandleSuccess(data) {
    this.Articles = data.data;
  }

  HandleError(error) {
    console.log(error);
  }

  GetAll()
  {
    this.articleservice.get().subscribe(
      data => this.HandleSuccess(data),
      error => this.HandleError(error)
    );
  }

  Delete(id:string)
  {
    this.articleservice.Destroy(id);
    location.reload();
  }

  Edit(Form:NgForm,article:any)
  {
    let param = JSON.stringify({
      article_id: article.id,
      title: Form.value.title,
      body : Form.value.body
    });
    this.ArticleToEdit = false;
    this.articleservice.store(param);
    location.reload();
  }

  ToEdit(article:any)
  {
    this.ArticleToEdit = true;
    this.articleE =  article;
  }

   ngOnInit() {
     this.GetAll();
    }
   

}
